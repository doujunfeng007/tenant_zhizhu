<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.minigod.zero.bpmn.module.account.mapper.OrganizationOpenInfoMapper">
    <resultMap id="BaseResultMap" type="com.minigod.zero.bpmn.module.account.vo.OrganizationOpenInfoVO">
        <id property="id" column="id" jdbcType="BIGINT"/>
        <result property="openAccountAccessWay" column="open_account_access_way" jdbcType="INTEGER"/>
        <result property="custId" column="cust_id" jdbcType="BIGINT"/>
        <result property="tenantId" column="tenant_id" jdbcType="VARCHAR"/>
        <result property="tradeAccount" column="trade_account" jdbcType="VARCHAR"/>
        <result property="companyName" column="company_name" jdbcType="VARCHAR"/>
        <result property="companyAddress" column="company_address" jdbcType="VARCHAR"/>
        <result property="companyRegistCertUrl" column="company_regist_cert_url" jdbcType="VARCHAR"/>
        <result property="businessRegistCertUrl" column="business_regist_cert_url" jdbcType="VARCHAR"/>
        <result property="registrationLocation" column="registration_location" jdbcType="VARCHAR"/>
        <result property="businessNature" column="business_nature" jdbcType="VARCHAR"/>
        <result property="fundingSource" column="funding_source" jdbcType="VARCHAR"/>
        <result property="contact" column="contact" jdbcType="VARCHAR"/>
        <result property="contactPhoneArea" column="contact_phone_area" jdbcType="VARCHAR"/>
        <result property="contactPhoneNumber" column="contact_phone_number" jdbcType="VARCHAR"/>
        <result property="contactPhoneAreaNumber" column="contact_phone_area_number" jdbcType="VARCHAR"/>
        <result property="contactEmail" column="contact_email" jdbcType="VARCHAR"/>
        <result property="purposeOpenAccount" column="purpose_open_account" jdbcType="VARCHAR"/>
        <result property="bankName" column="bank_name" jdbcType="VARCHAR"/>
        <result property="swiftCode" column="swift_code" jdbcType="VARCHAR"/>
        <result property="acceptRisk" column="accept_risk" jdbcType="INTEGER"/>
        <result property="expiryDate" column="expiry_date" jdbcType="DATE"/>
        <result property="accountName" column="account_name" jdbcType="VARCHAR"/>
        <result property="accountNumber" column="account_number" jdbcType="VARCHAR"/>
        <result property="approveStatus" column="approve_status" jdbcType="INTEGER"/>
        <result property="approveReason" column="approve_reason" jdbcType="VARCHAR"/>
        <result property="approveUserId" column="approve_user_id" jdbcType="BIGINT"/>
        <result property="approveUserName" column="approve_user_name" jdbcType="VARCHAR"/>
        <result property="approveDate" column="approve_date" jdbcType="TIMESTAMP"/>
        <result property="openDate" column="open_date" jdbcType="TIMESTAMP"/>
        <result property="openStatus" column="open_status" jdbcType="INTEGER"/>
        <result property="openResult" column="open_result" jdbcType="VARCHAR"/>
        <result property="createTime" column="create_time" jdbcType="TIMESTAMP"/>
        <result property="updateTime" column="update_time" jdbcType="TIMESTAMP"/>
        <result property="isDeleted" column="is_deleted" jdbcType="INTEGER"/>
        <result property="updateUser" column="update_user" jdbcType="BIGINT"/>
        <result property="createUser" column="create_user" jdbcType="BIGINT"/>
        <result property="createDept" column="create_dept" jdbcType="BIGINT"/>
        <result property="status" column="status" jdbcType="INTEGER"/>
    </resultMap>

    <sql id="Base_Column_List">
        id,open_account_access_way,cust_id,tenant_id,
        trade_account,company_name,company_address,
        company_regist_cert_url,business_regist_cert_url,registration_location,
        business_nature,funding_source,contact,contact_phone_area,
        contact_phone_number,CONCAT(IFNULL(contact_phone_area,''), IF(contact_phone_area is NULL OR contact_phone_area = '','','-'), IFNULL(contact_phone_number,'')) AS contact_phone_area_number,
        contact_email,purpose_open_account,
        bank_name,swift_code,accept_risk,expiry_date,account_name,
        account_number,approve_status,approve_reason,approve_user_id,approve_user_name,approve_date,
        open_date,open_status,open_result,
        create_time,update_time,is_deleted,
        update_user,create_user,create_dept,status
    </sql>

    <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List" />
        from organization_open_info
        where  id = #{id,jdbcType=BIGINT} and is_deleted = 0
    </select>

    <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
        update organization_open_info set is_deleted = 1
        where  id = #{id,jdbcType=BIGINT} and is_deleted = 0
    </delete>

    <insert id="insertSelective" keyColumn="id" keyProperty="id" parameterType="com.minigod.zero.bpmn.module.account.entity.OrganizationOpenInfoEntity" useGeneratedKeys="true">
        insert into organization_open_info
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">id,</if>
            <if test="openAccountAccessWay != null">open_account_access_way,</if>
            <if test="custId != null">cust_id,</if>
            <if test="tradeAccount != null">trade_account,</if>
            <if test="companyName != null">company_name,</if>
            <if test="companyAddress != null">company_address,</if>
            <if test="companyRegistCertUrl != null">company_regist_cert_url,</if>
            <if test="businessRegistCertUrl != null">business_regist_cert_url,</if>
            <if test="registrationLocation != null">registration_location,</if>
            <if test="businessNature != null">business_nature,</if>
            <if test="fundingSource != null">funding_source,</if>
            <if test="contact != null">contact,</if>
            <if test="contactPhoneArea != null">contact_phone_area,</if>
            <if test="contactPhoneNumber != null">contact_phone_number,</if>
            <if test="contactEmail != null">contact_email,</if>
            <if test="purposeOpenAccount != null">purpose_open_account,</if>
            <if test="bankName != null">bank_name,</if>
            <if test="swiftCode != null">swift_code,</if>
            <if test="acceptRisk != null">accept_risk,</if>
            <if test="expiryDate != null">expiry_date,</if>
            <if test="accountName != null">account_name,</if>
            <if test="accountNumber != null">account_number,</if>
            <if test="approveStatus != null">approve_status,</if>
            <if test="approveReason != null">approve_reason,</if>
            <if test="approveUserId != null">approve_user_id,</if>
            <if test="approveUserName != null">approve_user_name,</if>
            <if test="approveDate != null">approve_date,</if>
            <if test="openDate != null">open_date,</if>
            <if test="openStatus != null">open_status,</if>
            <if test="openResult != null">open_result,</if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">#{id,jdbcType=BIGINT},</if>
            <if test="openAccountAccessWay != null">#{openAccountAccessWay,jdbcType=INTEGER},</if>
            <if test="custId != null">#{custId,jdbcType=BIGINT},</if>
            <if test="tradeAccount != null">#{tradeAccount,jdbcType=VARCHAR},</if>
            <if test="companyName != null">#{companyName,jdbcType=VARCHAR},</if>
            <if test="companyAddress != null">#{companyAddress,jdbcType=VARCHAR},</if>
            <if test="companyRegistCertUrl != null">#{companyRegistCertUrl,jdbcType=VARCHAR},</if>
            <if test="businessRegistCertUrl != null">#{businessRegistCertUrl,jdbcType=VARCHAR},</if>
            <if test="registrationLocation != null">#{registrationLocation,jdbcType=VARCHAR},</if>
            <if test="businessNature != null">#{businessNature,jdbcType=VARCHAR},</if>
            <if test="fundingSource != null">#{fundingSource,jdbcType=VARCHAR},</if>
            <if test="contact != null">#{contact,jdbcType=VARCHAR},</if>
            <if test="contactPhoneArea != null">#{contactPhoneArea,jdbcType=VARCHAR},</if>
            <if test="contactPhoneNumber != null">#{contactPhoneNumber,jdbcType=VARCHAR},</if>
            <if test="contactEmail != null">#{contactEmail,jdbcType=VARCHAR},</if>
            <if test="purposeOpenAccount != null">#{purposeOpenAccount,jdbcType=VARCHAR},</if>
            <if test="bankName != null">#{bankName,jdbcType=VARCHAR},</if>
            <if test="swiftCode != null">#{swiftCode,jdbcType=VARCHAR},</if>
            <if test="acceptRisk != null">#{acceptRisk,jdbcType=INTEGER},</if>
            <if test="expiryDate != null">#{expiryDate,jdbcType=TIMESTAMP},</if>
            <if test="accountName != null">#{accountName,jdbcType=VARCHAR},</if>
            <if test="accountNumber != null">#{accountNumber,jdbcType=VARCHAR},</if>
            <if test="approveStatus != null">#{approveStatus,jdbcType=INTEGER},</if>
            <if test="approveReason != null">#{approveReason,jdbcType=VARCHAR},</if>
            <if test="approveUserId != null">#{approveUserId,jdbcType=BIGINT},</if>
            <if test="approveUserName != null">#{approveUserName,jdbcType=VARCHAR},</if>
            <if test="approveDate != null">#{approveDate,jdbcType=TIMESTAMP},</if>
            <if test="openDate != null">#{openDate,jdbcType=TIMESTAMP},</if>
            <if test="openStatus != null">#{openStatus,jdbcType=INTEGER},</if>
            <if test="openResult != null">#{openResult,jdbcType=VARCHAR},</if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.minigod.zero.bpmn.module.account.entity.OrganizationOpenInfoEntity">
        update organization_open_info
        <set>
            <if test="openAccountAccessWay != null">
                open_account_access_way = #{openAccountAccessWay,jdbcType=INTEGER},
            </if>
            <if test="custId != null">
                cust_id = #{custId,jdbcType=BIGINT},
            </if>
            <if test="tradeAccount != null">
                trade_account = #{tradeAccount,jdbcType=VARCHAR},
            </if>
            <if test="companyName != null">
                company_name = #{companyName,jdbcType=VARCHAR},
            </if>
            <if test="companyAddress != null">
                company_address = #{companyAddress,jdbcType=VARCHAR},
            </if>
            <if test="companyRegistCertUrl != null">
                company_regist_cert_url = #{companyRegistCertUrl,jdbcType=VARCHAR},
            </if>
            <if test="businessRegistCertUrl != null">
                business_regist_cert_url = #{businessRegistCertUrl,jdbcType=VARCHAR},
            </if>
            <if test="registrationLocation != null">
                registration_location = #{registrationLocation,jdbcType=VARCHAR},
            </if>
            <if test="businessNature != null">
                business_nature = #{businessNature,jdbcType=VARCHAR},
            </if>
            <if test="fundingSource != null">
                funding_source = #{fundingSource,jdbcType=VARCHAR},
            </if>
            <if test="contact != null">
                contact = #{contact,jdbcType=VARCHAR},
            </if>
            <if test="contactPhoneArea != null">
                contact_phone_area = #{contactPhoneArea,jdbcType=VARCHAR},
            </if>
            <if test="contactPhoneNumber != null">
                contact_phone_number = #{contactPhoneNumber,jdbcType=VARCHAR},
            </if>
            <if test="contactEmail != null">
                contact_email = #{contactEmail,jdbcType=VARCHAR},
            </if>
            <if test="purposeOpenAccount != null">
                purpose_open_account = #{purposeOpenAccount,jdbcType=VARCHAR},
            </if>
            <if test="bankName != null">
                bank_name = #{bankName,jdbcType=VARCHAR},
            </if>
            <if test="swiftCode != null">
                swift_code = #{swiftCode,jdbcType=VARCHAR},
            </if>
            <if test="acceptRisk != null">
                accept_risk = #{acceptRisk,jdbcType=INTEGER},
            </if>
            <if test="expiryDate != null">
                expiry_date = #{expiryDate,jdbcType=TIMESTAMP},
            </if>
            <if test="accountName != null">
                account_name = #{accountName,jdbcType=VARCHAR},
            </if>
            <if test="accountNumber != null">
                account_number = #{accountNumber,jdbcType=VARCHAR},
            </if>
            <if test="approveStatus != null">
                approve_status = #{approveStatus,jdbcType=INTEGER},
            </if>
            <if test="approveReason != null">
                approve_reason = #{approveReason,jdbcType=VARCHAR},
            </if>
            <if test="approveUserId != null">
                approve_user = #{approveUserId,jdbcType=BIGINT},
            </if>
            <if test="approveUserName != null">
                approve_user_name = #{approveUserName,jdbcType=VARCHAR},
            </if>
            <if test="approveDate != null">
                approve_date = #{approveDate,jdbcType=TIMESTAMP},
            </if>
            <if test="openDate != null">
                open_date = #{openDate,jdbcType=TIMESTAMP},
            </if>
            <if test="openStatus != null">
                open_status = #{openStatus,jdbcType=INTEGER},
            </if>
            <if test="openResult != null">
                open_result = #{openResult,jdbcType=VARCHAR},
            </if>
        </set>
        where id = #{id,jdbcType=BIGINT} and is_deleted = 0
    </update>
    <update id="updateByPrimaryKey" parameterType="com.minigod.zero.bpmn.module.account.entity.OrganizationOpenInfoEntity">
        update organization_open_info
        set
            open_account_access_way =  #{openAccountAccessWay,jdbcType=INTEGER},
            cust_id =  #{custId,jdbcType=BIGINT},
            trade_account =  #{tradeAccount,jdbcType=VARCHAR},
            company_name =  #{companyName,jdbcType=VARCHAR},
            company_address =  #{companyAddress,jdbcType=VARCHAR},
            company_regist_cert_url =  #{companyRegistCertUrl,jdbcType=VARCHAR},
            business_regist_cert_url =  #{businessRegistCertUrl,jdbcType=VARCHAR},
            registration_location =  #{registrationLocation,jdbcType=VARCHAR},
            business_nature =  #{businessNature,jdbcType=VARCHAR},
            funding_source =  #{fundingSource,jdbcType=VARCHAR},
            contact =  #{contact,jdbcType=VARCHAR},
            contact_phone_area =  #{contactPhoneArea,jdbcType=VARCHAR},
            contact_phone_number =  #{contactPhoneNumber,jdbcType=VARCHAR},
            contact_email =  #{contactEmail,jdbcType=VARCHAR},
            purpose_open_account =  #{purposeOpenAccount,jdbcType=VARCHAR},
            bank_name =  #{bankName,jdbcType=VARCHAR},
            swift_code =  #{swiftCode,jdbcType=VARCHAR},
            accept_risk =  #{acceptRisk,jdbcType=INTEGER},
            expiry_date =  #{expiryDate,jdbcType=TIMESTAMP},
            account_name =  #{accountName,jdbcType=VARCHAR},
            account_number =  #{accountNumber,jdbcType=VARCHAR},
            approve_status =  #{approveStatus,jdbcType=INTEGER},
            approve_reason =  #{approveReason,jdbcType=VARCHAR},
            approve_user_id =  #{approveUserId,jdbcType=BIGINT},
            approve_user_name =  #{approveUserName,jdbcType=VARCHAR},
            approve_date =  #{approveDate,jdbcType=TIMESTAMP},
            open_date =  #{openDate,jdbcType=TIMESTAMP},
            open_status =  #{openStatus,jdbcType=INTEGER},
            open_result =  #{openResult,jdbcType=VARCHAR}
        where id = #{id,jdbcType=BIGINT} and is_deleted = 0
    </update>

    <select id="selectByPage" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from organization_open_info AS info
        <where>
            <if test="query.openAccountAccessWay != null">
                and info.open_account_access_way = #{query.openAccountAccessWay}
            </if>
            <if test="query.companyName != null and query.companyName != ''">
                and info.company_name LIKE concat('%',#{query.companyName},'%')
            </if>
            <if test="query.companyAddress != null and query.companyAddress != ''">
                and info.company_address LIKE concat('%',#{query.companyAddress},'%')
            </if>
            <if test="query.registrationLocation != null and query.registrationLocation != ''">
                and info.registration_location LIKE concat('%',#{query.registrationLocation},'%')
            </if>
            <if test="query.businessNature != null and query.businessNature != ''">
                and info.business_nature LIKE concat('%',#{query.businessNature},'%')
            </if>
            <if test="query.fundingSource != null and query.fundingSource != ''">
                and info.funding_source LIKE concat('%', concat(#{query.fundingSource}, '%'))
            </if>
            <if test="query.contact != null and query.contact != ''">
                and info.contact = #{query.contact}
            </if>
            <if test="query.bankName != null and query.bankName != ''">
                and info.bank_name = #{query.bankName}
            </if>
            <if test="query.accountName != null and query.accountName != ''">
                and info.account_name = #{query.accountName}
            </if>
            <if test="query.accountNumber != null and query.accountNumber != ''">
                and info.account_number = #{query.accountNumber}
            </if>
            <if test="query.purposeOpenAccount != null and query.purposeOpenAccount != ''">
                and info.purpose_open_account = #{query.purposeOpenAccount}
            </if>
            <if test="query.beginOpenDate != null and query.beginOpenDate != ''">
                and info.open_date >= #{query.beginOpenDate}
            </if>
            <if test="query.endOpenDate != null and query.endOpenDate != ''">
                and info.open_date <![CDATA[ <= ]]>#{query.endOpenDate}
            </if>
            <if test="query.beginApproveDate != null and query.beginApproveDate != ''">
                and info.approve_date >= #{query.beginApproveDate}
            </if>
            <if test="query.endApproveDate != null and query.endApproveDate != ''">
                and info.approve_date <![CDATA[ <= ]]>#{query.endApproveDate}
            </if>
            and is_deleted = 0
        </where>
        order by info.open_date desc
    </select>
</mapper>
