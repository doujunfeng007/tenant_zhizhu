<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.minigod.zero.manage.mapper.PlatformTemplateTypeMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="platformTemplateTypeResultMap" type="com.minigod.zero.platform.entity.PlatformTemplateTypeEntity">
        <result column="id" property="id"/>
        <result column="bus_type" property="busType"/>
        <result column="temp_name" property="tempName"/>
        <result column="parent_id" property="parentId"/>
        <result column="send_way" property="sendWay"/>
        <result column="create_user" property="createUser"/>
        <result column="create_dept" property="createDept"/>
        <result column="create_time" property="createTime"/>
        <result column="update_user" property="updateUser"/>
        <result column="update_time" property="updateTime"/>
        <result column="status" property="status"/>
        <result column="is_deleted" property="isDeleted"/>
    </resultMap>

    <select id="selectPlatformTemplateTypePage" resultMap="platformTemplateTypeResultMap">
        select * from platform_template_type where is_deleted = 0
    </select>

    <select id="findTemplate" resultType="com.minigod.zero.manage.vo.MsgTemplateVO">
        select t2.id, t2.bus_id, t1.parent_id, t1.send_way, t1.temp_name, t2.title, t2.title_hant, t2.title_en,
        t2.content, t2.content_hant, t2.content_en, t2.temp_code, t2.apply_explain, t2.msg_type from platform_template_type t1 left join platform_common_template t2 on t1.id = t2.bus_id
        where t2.id = #{id}
    </select>

    <update id="update" parameterType="com.minigod.zero.platform.entity.PlatformTemplateTypeEntity">
        update platform_template_type
        <trim prefix="SET" suffixOverrides=",">
            <if test="updateUser != null">update_user =
                #{updateUser},
            </if>
            <if test="updateTime != null">update_time =
                #{updateTime},
            </if>
            <if test="status != null">`status` =
                #{status},
            </if>
            <if test="isDeleted != null">is_deleted =
                #{isDeleted},
            </if>
        </trim>
        where id = #{id}
    </update>

</mapper>
